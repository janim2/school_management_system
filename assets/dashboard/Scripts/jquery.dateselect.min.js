/**
* jQuery DateSelect
* @author biohzrdmx <github.com/biohzrdmx>
* @version 1.0
* @requires jQuery 1.8+
* @license MIT
*/
;!function(e){e.dateSelect={templates:{selector:'<div class="date-select"><div class="date-select popup"><span class="tip"></span><div class="select day"><a href="#" class="btn-arrow btn-up"><i class="icon icon-up"></i></a><div><span class="num">01</span><span class="text">Thursday</span></div><a href="#" class="btn-arrow btn-down"><i class="icon icon-down"></i></a></div><div class="select month"><a href="#" class="btn-arrow btn-up"><i class="icon icon-up"></i></a><div><span class="num">01</span><span class="text">September</span></div><a href="#" class="btn-arrow btn-down"><i class="icon icon-down"></i></a></div><div class="select year"><a href="#" class="btn-arrow btn-up"><i class="icon icon-up"></i></a><div><span class="num">2014</span></div><a href="#" class="btn-arrow btn-down"><i class="icon icon-down"></i></a></div><div class="buttons"><a href="#" class="btn-cancel"><i class="fa fa-times"></i></a><a href="#" class="btn-ok"><i class="fa fa-check"></i></a></div></div></div>'},defaults:{formatDate:function(t){return e.dateSelect.pad(t.getDate(),2)+"/"+e.dateSelect.pad(t.getMonth()+1,2)+"/"+t.getFullYear()},parseDate:function(e){var t=new Date,n=e.match(/(\d{1,2})\/(\d{1,2})\/(\d{4})/);return n&&4==n.length&&(t=new Date(n[3],n[2]-1,n[1])),t},callbacks:{onShow:function(e){},onHide:function(e){}},container:"body",element:null,date:(new Date).toDateString(),strings:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],months:["January","February","March","April","May","June","July","August","September","October","November","December"]}},pad:function(e,t){for(var n=e+"";n.length<t;)n="0"+n;return n},update:function(e,t,n){var a=e.find(".day"),c=e.find(".month"),l=e.find(".year"),i=a.find(".num"),s=c.find(".num"),o=l.find(".num"),d=a.find(".text"),r=c.find(".text"),u=t.getDate();curWeekday=t.getDay(),curMonth=t.getMonth(),curYear=t.getFullYear(),i.text(u),s.text(curMonth+1),o.text(curYear),d.text(n.strings.days[curWeekday]),r.text(n.strings.months[curMonth])},show:function(t){var n=this,a=e.extend(!0,{},e.dateSelect.defaults,t),c=e(n.templates.selector),l=new Date(a.date);if(n.hide(!0),a.element&&("string"==typeof a.element&&(a.element=e(a.element)),l=a.parseDate(a.element.val())),n.update(c,l,a),c.on("click",".day .btn-up",function(e){l.setDate(l.getDate()+1),n.update(c,l,a),e.preventDefault()}),c.on("click",".day .btn-down",function(e){l.setDate(l.getDate()-1),n.update(c,l,a),e.preventDefault()}),c.on("click",".month .btn-up",function(e){l.setMonth(l.getMonth()+1),n.update(c,l,a),e.preventDefault()}),c.on("click",".month .btn-down",function(e){l.setMonth(l.getMonth()-1),n.update(c,l,a),e.preventDefault()}),c.on("click",".year .btn-up",function(e){l.setFullYear(l.getFullYear()+1),n.update(c,l,a),e.preventDefault()}),c.on("click",".year .btn-down",function(e){l.setFullYear(l.getFullYear()-1),n.update(c,l,a),e.preventDefault()}),c.on("click",".btn-ok",function(t){t.preventDefault();var c=a.formatDate(l);e(a.element).val(c),e(a.element).trigger("change"),n.hide()}),c.on("click",".btn-cancel",function(e){e.preventDefault(),n.hide()}),c.on("mousewheel",".day",function(t){t.deltaY>0?e(".day .btn-up").trigger("click"):t.deltaY<0&&e(".day .btn-down").trigger("click")}),c.on("mousewheel",".month",function(t){t.deltaY>0?e(".month .btn-up").trigger("click"):t.deltaY<0&&e(".month .btn-down").trigger("click")}),c.on("mousewheel",".year",function(t){t.deltaY>0?e(".year .btn-up").trigger("click"):t.deltaY<0&&e(".year .btn-down").trigger("click")}),c.hide(),e(a.container).append(c),a.element){var i=a.element.offset();c.css({left:i.left+"px",top:i.top+a.element.outerHeight(!0)+15+"px"})}c.data("opts",a),c.fadeIn(150,function(){a.callbacks.onShow(c)})},hide:function(t){t=t||!1;var n=e(".date-select"),a=n.data("opts");n.length&&(t?(a.callbacks.onHide(n),n.remove()):n.fadeOut(150,function(){a.callbacks.onHide(n),n.remove()}))}},e.fn.dateSelect=function(t){if(!this.length)return this;e.extend(!0,{},e.dateSelect.defaults,t);return this.each(function(){var t=e(this),n=t.parent();t.on("click",function(){e.dateSelect.show({element:t})}),n.find("[data-toggle=select]").on("click",function(n){n.preventDefault(),e(".date-select:visible").length?e.dateSelect.hide():e.dateSelect.show({element:t})})}),this},e("[data-select=date]").each(function(){e(this).dateSelect()})}(jQuery);